#!/usr/bin/env bash
set -euo pipefail

# Resolve the real path of this script (handles symlinks)
SCRIPT_PATH="$(readlink -f "${BASH_SOURCE[0]}")"
SCRIPT_DIR="$(cd "$(dirname "$SCRIPT_PATH")" && pwd)"
PROJECT_DIR="$(cd "$SCRIPT_DIR/.." && pwd)"

VENV_DIR="$PROJECT_DIR/.venv"
SCRIPT_FILE="$PROJECT_DIR/mc_pm.py"

if [ ! -f "$SCRIPT_FILE" ]; then
    echo "Error: mc_pm.py not found at $SCRIPT_FILE"
    exit 1
fi

if [ ! -d "$VENV_DIR" ]; then
    echo "Error: virtualenv not found at $VENV_DIR"
    echo "Run from project root:  ./setup_env.sh"
    exit 1
fi

# Activate venv and run
# shellcheck source=/dev/null
source "$VENV_DIR/bin/activate"
python "$SCRIPT_FILE" "$@"

